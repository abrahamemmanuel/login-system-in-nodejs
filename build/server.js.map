{"version":3,"sources":["../src/server.js"],"names":["app","require","passport","use","express","static","path","join","__dirname","set","urlencoded","extended","cookie","secure","maxAge","secret","saveUninitialized","resave","initialize","session","req","res","next","Error","locals","success_msg","flash","error_msg","error","router","db","process","env","MONGODB_URI","key","LOCALDB_URI","mongoose","connect","useNewUrlParser","then","console","log","catch","err","get","render","module","parent","listen"],"mappings":"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","sourcesContent":["import express from 'express';\nimport passport from 'passport'\nimport expressLayouts from 'express-ejs-layouts';\nimport flash from 'connect-flash';\nimport session from 'express-session';\nimport mongoose from 'mongoose';\nimport key from './config/keys';\nimport router from './routes/index';\nimport path from 'path';\n\nconst app = express();\n\n// Passport Config\nrequire('./config/passport')(passport);\n\n//Static folder\napp.use(express.static(path.join(__dirname, './public/')));\napp.use('/css', express.static(path.join(__dirname, 'public/css')));\n//Set View Engine\napp.set('views', './views');\napp.set('view engine', 'ejs');\n\n// // EJS\n// app.use(expressLayouts);\n// app.set('view engine', 'ejs');\n\n\n\n// Bodyparser\napp.use(express.urlencoded({ extended: true }));\n\n//-momery unleaked---------\napp.set('trust proxy', 1);\n\n// Express session\napp.use(session({\n  cookie:{\n      secure: true,\n      maxAge:60000\n         },\n  secret: 'secret',\n  saveUninitialized: true,\n  resave: false\n  }));\n\n\n\n//Passport middleware\napp.use(passport.initialize());\napp.use(passport.session());\n\n// Connect flashhero\napp.use(flash());\n\n// Global Vars\napp.use((req, res, next) => {\n  if(!req.session){\n    return next(new Error('Oops an error occured')) //handle error\n}\n  res.locals.success_msg = req.flash('success_msg');\n  res.locals.error_msg = req.flash('error_msg');\n  res.locals.error = req.flash('error');\n  next();\n});\n\n// Routes\napp.use(router);\n\n// DB Config\nconst db = process.env.MONGODB_URI || key.LOCALDB_URI;\n\n// Connect to MongoDB\nmongoose.connect(db, { useNewUrlParser: true }).then(() => console.log('MongoDB Connected...')).catch(err => console.log(err));\n\n\n\n// @route   /\n// @desc     Get the landing page\n// @access   Public\n\n// @method   GET\n\napp.get('/', (req, res) => {\n  return  res.render('welcome');\n });\n\n\n\nif (!module.parent) { app.listen(key.env, () => console.log(`Server running on port ${key.env}`)); }// eslint-disable-line no-console\n\n// app.listen(key.env, () => {console.log(`Server running on port ${key.env}`)});\n\nexport default app;\n"],"file":"server.js"}